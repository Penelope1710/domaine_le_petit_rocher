{% extends 'base.html.twig'  %}

{% block title %}Présentation de l'Ecurie!{% endblock %}

{% block body %}
<div id="banniere">
    <h2 class="titre-secondaire">L'ECURIE</h2>
</div>
    <div class="titre-tertiaire">
        <h3>Les évènements aux Ecuries</h3>
        <p>Date du jour : {{ currentDate|date("d/m/Y") }}</p>
    </div>

<section class="event-filtre-affichage">

    {% include 'inc/_filter.html.twig' %}

    <table class="events-list">
        <thead>
        <tr>

            <th>Nom de l'évènement</th>

            <th>Catégorie</th>
            <th>Date</th>
            <th>Heure</th>
            <th>Fin des Inscriptions</th>
            <th>Les inscrits</th>
            <th>Statut</th>
            <th>Organisateur</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for event in events %}
            <tr>
                <td>
                <div class="position-left">
                    <a href="{{ path('ecurieevent_details', {'id': event.id}) }}">
                        {{ event.name }}
                </div>
                    </a>
                </td>
                <td>{{ event.category.name }}</td>
                <td>{{ event.startDate|date('d-m-y') }}</td>
                <td>{{ event.startTime|date('H') }}h{{ event.startTime| date('i') }}</td>
                <td>{{ event.deadLine|date('d-m-y') }}</td>
                {# Afficher la liste des inscrits en info bulle #}
                <td>
                    {{ event.eventCustomer.count }}
                    <span class="info-bulle" title="Inscrits :
                        {% for eventCustomer in event.eventCustomer %}
                            {{ eventCustomer.customer.firstName }} {{ eventCustomer.customer.lastName[:1]|upper }}
                            {% if not loop.last %}
                                <br>
                            {% endif %}
                       {% endfor %}"
                    >
                    </span>
                </td>
                <td>{{ event.deadLine > currentDate ? 'Ouvert' : 'Fermé' }}</td>
                <td>{{ event.createdBy.customer.firstName ~ ' ' ~ event.createdBy.customer.lastName[:1]|upper }}</td>
                <td>
                    {% include('inc/_affichage_actions.html.twig') %}
                </td>

            <tr>
                {# todo les conditions des différentes colonnes dans un autre fichier qu'on va include #}

            </tr>
        {% endfor %}
        </tbody>
    </table>
    <div class="btn-event-plan">
        <a href="{{ path('ecurieevent_create') }}">Plannifier un évènement</a>
    </div>
</section>
{% endblock %}